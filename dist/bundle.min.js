!function(o,t){"object"==typeof exports&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,function(){"use strict";function o(o,e){var n="",r=o.data||o.json||"",a="";switch(typeof r){case"object":a=JSON.stringify(r),n="application/json";break;case"string":if(r.length>1&&("{"===r[0]||"["===r[0]))try{JSON.parse(r),console&&console.warn&&console.warn("dasu: Sending data that may be JSON as text/plain")}catch(o){}a=r,n="text/plain";break;default:a=""+r,n="text/plain"}o=Object.assign({},o),delete o.data,o.headers=Object.assign({},{"content-type":n},o.headers||{}),o.method=o.method||"GET",o.path=o.path||"/","/"!==o.path[0]&&(o.path="/"+o.path);var s={protocol:o.protocol,hostname:o.hostname,port:o.port,path:o.path,method:o.method,headers:o.headers};return t(s,a,function(o,t,n){o||void 0===t?e(o):(!t.getResponseHeader&&t.headers&&(t.getResponseHeader=function(o){return t.headers[o]}),t.getAllResponseHeaders&&!t.headers&&(t.headers=t.getAllResponseHeaders()),void 0===t.status?t.status=t.statusCode:t.statusCode=t.status,e(void 0,t,n))})}var t=function(){throw new Error("dasu: No request implemention specified in dasu.js")};if("undefined"!=typeof window&&void 0!==window.XMLHttpRequest)t=function(o,t,e){var n=new window.XMLHttpRequest;o.protocol=o.protocol||window.location.protocol||"http",":"!==o.protocol[o.protocol.length-1]&&(o.protocol+=":"),o.hostname=o.hostname||window.location.hostname;var r=80;o.protocol&&(r=-1!==o.protocol.indexOf("https")?443:80);var a=o.hostname.toLowerCase().trim(),s=window.location.hostname.toLowerCase().trim();-1!==a.indexOf(s)&&(r=window.location.port||r),o.port=o.port||r;var i=o.protocol+"//"+o.hostname+(o.port?":"+o.port:""),p=i+o.path;console.log("dasu: url ["+p+"]"),n.open(o.method,p,!0),n.onload=function(){e(null,n,n.responseText)},n.onerror=function(){e(n.responseText||"dasu.js XMLHttpRequest error")};for(var d=Object.keys(o.headers),c=0;c<d.length;c++){var l=d[c],u=o.headers[l];n.setRequestHeader(l,u)}return n.send(t),{abort:function(){n.abort()}}};else{var e=require,n=e("http"),r=e("https");t=function(o,t,e){o=o||{},o.protocol=o.protocol||"http";var a=n;o.protocol&&-1!==o.protocol.indexOf("https")&&(a=r),":"!==o.protocol[o.protocol.length-1]&&(o.protocol+=":");var s=a.request(o,function(o){var t="";o.on("data",function(o){t+=o}),o.on("end",function(){e(null,o,t)})});return s.on("error",function(o){e(o)}),s.write(t),s.end(),{abort:function(){s.abort()}}}}var a={xhr:function(t,e){o(t,function(o,t,n){e(o,n)})},req:o};module.exports=a});